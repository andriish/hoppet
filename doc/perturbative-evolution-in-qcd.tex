\section{Perturbative evolution in QCD}
\label{sec:pqcd}
First of all we set up the notation and
conventions that are used throughout \hoppet. The DGLAP
equation for a non-singlet parton distribution reads
\begin{equation}
  \label{eq:dglap-ns}
  \frac{\partial q(x,Q^2)}{\partial \ln Q^2} = 
\frac{\aq}{2\pi}\int_x^1 \frac{dz}{z}
  P(z,\aq) q\lp \frac{x}{z},Q^2\rp \equiv 
\frac{\aq}{2\pi}  P(x,\aq) \otimes q\lp x,Q^2\rp \ .
\end{equation}
The related variable $t\equiv \ln Q^2$ is also used
in various places in \hoppet.
The splitting functions in eq.~(\ref{eq:dglap-ns})
are known up to NNLO in the 
unpolarised case \cite{Furmanski:1980cm,Curci:1980uw,NNLO-NS,NNLO-singlet}:
\begin{equation}
  \label{eq:dpdf}
   P(z,\aq)=P^{(0)}(z)+\frac{\aq}{2\pi}P^{(1)}(z)+
\lp \frac{\aq}{2\pi} \rp^2 P^{(2)}(z) \ ,
\end{equation}
and up to NLO \cite{Mertig:1995ny,Vogelsang:1996im} in the polarised case.
The generalisation to the singlet case is straightforward, as it
is 
%the generalisation of eq.~(\ref{eq:dglap-ns}) 
to the case of time-like evolution\footnote{
The general structure of the relation between space-like
and time-like evolution and splitting functions
 has been investigated in \cite{Furmanski:1980cm,Curci:1980uw,Stratmann:1996hn,Dokshitzer:2005bf,Mitov:2006ic,Basso:2006nk,Dokshitzer:2006nm,Beccaria:2007bb}.}, 
relevant for example for fragmentation function analysis,
where partial NNLO results
are also available \cite{Mitov:2006ic}.


As with the splitting functions, all perturbative quantities in
\hoppet are defined to be coefficients of powers of $\as/2\pi$. The one
exception is the $\beta$-function coefficients of the running
coupling equation:
\begin{equation}
  \label{eq:as-ev}
  \frac{d\as}{d\ln Q^2} = \beta\lp \aq\rp = -\as (\beta_0\as +
  \beta_1\as^2 + 
  \beta_2\as^3 + 
  \beta_3\as^4) \ .
\end{equation}

The evolution of the strong coupling and the parton distributions can
be performed in both the fixed flavour-number scheme (FFNS) and the 
variable flavour-number scheme (VFNS). In the VFNS case we 
need the matching conditions between the effective
theories with $n_f$ and $n_{f}+1$ light flavours for both the strong 
coupling $\aq$ and the parton distributions at the heavy quark
mass threshold $m_h^2$.

These matching conditions for the parton distributions
receive non-trivial contributions at higher orders. In the $\MSbar$
(factorisation) scheme, for example, these begin at NNLO:\footnote{In
  a general scheme they would start at NLO.} %
for light quarks $q_{l,i}$ of flavour $i$ 
(quarks that are considered massless
below the heavy quark mass threshold $m_h^2$) the matching between
their values in the $n_f$ and
$n_f+1$ effective theories reads:
\begin{equation}
\label{eq:lp-nf1}
  q_{l,i}^{\,(n_f+1)}(x,m_h^2) \: = \:  q_{l,i}^{\,(\nf}(x,m_h^2) +
\lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^2
   A^{\rm ns,(2)}_{qq,h}(x) \otimes
  q_{l,i}^{\, (\nf}(x,m_h^2) \ ,
\end{equation}
where  $i = 1,\ldots n_f$, while for the gluon
distribution and the heavy quark PDF $q_h$ one has a coupled matching 
condition:
\begin{align}
\label{eq:hp-nf1}
  g^{(n_f+1)}(x,m_h^2) \:\:\: &=
    g^{\, (\nf}(x,m_h^2) 
\\ &+ \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^2 \Big[
    A_{\rm gq,h}^{S,(2)}(x) \otimes \Sigma^{(\nf}(x,m_h^2) +
    A_{\rm gg,h}^{S,(2)}(x) \otimes g^{(\nf}(x,m_h^2) \Big ]\ ,
  \nn \\[0.5mm] 
  (q_h+\bar{q}_{h})^{(n_f+1)}(x,m_h^2)  &=
   \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^2 \Big [
    \tilde{A}_{\rm hq}^{S,(2)}(x)\otimes \Sigma^{(\nf}(x,m_h^2) 
    + \tilde{A}_{\rm hg}^{S,(2)}(x)\otimes g^{(\nf}(x,m_h^2) \Big  ] \ ,
  \quad \nonumber
\end{align}
with $q_h=\bar{q}_h$, and the singlet PDF $\Sigma(x,Q^2)$ is defined
in Table \ref{eq:diag_split}.
The NNLO matching coefficients were
computed in \cite{NNLO-MTM}\footnote{The authors are thanked 
for the code corresponding to the
calculation.}.
Notice that the above conditions will lead to small discontinuities
of the PDFs in its evolution in $Q^2$, 
which are cancelled by similar matching terms
in the coefficient functions resulting in continuous physical
observables. In particular, the heavy quark PDFs start from a non-zero
value at threshold at NNLO, which sometimes can even be
negative.

The corresponding NNLO relation for the matching of the $\MSbar$
coupling constant at the heavy quark threshold $m^2_h$ is given by 
\begin{equation}
\label{eq:as-nf1}
  \as^{\, (n_f+1)}(m_h^2) \: = \:
  \as^{\, (\nf} (m_h^2) +   C_2 \lp \frac{\as^{\, (\nf} (m_h^2)}{2\pi} \rp^3
   \:\: ,
\end{equation}
where the matching coefficient $C_2$ was computed in \cite{Chetyrkin:1997sg}.
%
The value of $C_2$ and the form of the matching coefficients in
eqs.~(\ref{eq:lp-nf1},\ref{eq:hp-nf1}) depend on the scheme used for
the quark masses; by default in \hoppet quark masses are taken to be
pole masses, though the option exists for the user to supply and have
thresholds crossed at $\MSbar$ masses.

Both evolution and threshold matching preserve the momentum sum rule
\begin{equation}
  \int_0^1 dx~x \lp \Sigma(x,Q^2)+g(x,Q^2)\rp =1 \,,
\end{equation}
and valence sum rules
\begin{equation}
  \int_0^1 dx\, \left[q(x,Q^2)-{\bar q}(x,Q^2) \right] = \left\{ 
    \begin{array}{ll}
      1, & \text{for } q = d \text{ (in proton)}\\
      2, & \text{for } q = u \text{ (in proton)}\\
      0, & \text{other flavours}
    \end{array}
    \right.
\end{equation}
as long as they hold at the initial scale (occasionally not the case,
\eg in modified LO sets for Monte Carlo
generators~\cite{Sherstnev:2008dm}).

The default basis for the PDFs, called the \ttt{human} 
representation in \hoppet, is such that 
 the entries in an array
\ttt{pdf(-6:6)} of PDFs correspond to:
\bea 
\bar t={-6} \ ,  \bar b={-5} \ ,  \bar c={-4}
\ , \nn   \bar s&=&{-3} \ , \nn  \bar u={-2} \ , \nn
 \bar d={-1} \ , \\  g&=&{0} \ , \\ \nn   d={1} \ , \nn  u={2} 
\ , \nn  
s={3} \ , \nn   c&=&{4} \ , \nn b={5} \ , \nn  t={6} \ . \nn 
\eea
 This representation is the
same as that used in the \ttt{LHAPDF} library \cite{LHAPDF}. 
However, this representation leads
to a complicated form of the evolution equations.
The splitting matrix can be simplified considerably (made diagonal
except for a $2\times2$ singlet block) by switching to a different
flavour representation, which is named
the \ttt{evln} representation, for the PDF set, as explained in detail in
\cite{vanNeerven:1999ca,vanNeerven:2000uj}. This representation
is described in Table \ref{eq:diag_split}.

In the {\tt evln} basis, 
the gluon evolves coupled to the singlet  PDF $\Sigma$,
and all non-singlet PDFs evolve independently.
Notice that the representations of the PDFs
are preserved under linear operations, so in particular
they are preserved under DGLAP evolution.
The conversion from the \ttt{human} to the \ttt{evln}
representations of PDFs requires that the number of
active quark flavours $n_f$ be specified by the user, as described in
section~\ref{sec:evln-rep}.

\begin{table}
\begin{center}
\begin{tabular}{|r | c | l |}
\hline
     i & \mbox{name} & $q_i$ \\ \hline
     $ -6\ldots-(n_f+1)$ & $q_i$ & $q_i$\\
     $-n_f\ldots -2$ & $q_{\mathrm{NS},i}^{-}$ & 
$(q_i -  {\bar q}_i) - (q_1 - {\bar q}_1)$\\
      -1           & $q_{\mathrm{NS}}^{V}$ & 
$\sum_{j=1}^{n_f} (q_j -  {\bar q}_j)$\\
       0           & g & \textrm{gluon} \\
       1           & $\Sigma$ & $\sum_{j=1}^{n_f} (q_j +  {\bar q}_j)$\\
     $2\ldots n_f$ & $q_{\mathrm{NS},i}^{+}$ &
$ (q_i +  {\bar q}_i) - (q_1 + {\bar q}_1)$\\
      $(n_f+1)\ldots6$ & $q_i$ & $q_i$ \\
\hline
\end{tabular}
\caption{}{\label{eq:diag_split} The evolution representation 
(called \ttt{evln} in \hoppet)
of PDFs with $n_f$ active quark flavours
in terms of the \ttt{human} representation.}  
\end{center}
\end{table}

In \hoppet unpolarised DGLAP evolution is available up to NNLO
in the $\MSbar$ scheme, while for the DIS scheme
only evolution up to NLO is available, but without the NLO heavy-quark
threshold matching conditions. For polarised evolution only
the $\MSbar$ scheme is available. The variable \ttt{factscheme}
takes different values for each factorisation scheme:
\begin{center}
  \begin{tabular}{|c|l|}\hline
    \ttt{factscheme} & Evolution\\[2pt]\hline
    1 & unpolarised $\MSbar$ scheme\\[2pt]\hline
    2 & unpolarised DIS scheme\\[2pt]\hline
    3 & polarised $\MSbar$ scheme\\\hline
  \end{tabular}
\end{center}
Note that mass thresholds are currently
missing in the DIS scheme.
